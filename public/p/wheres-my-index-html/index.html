<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Where's My index.html? | A blog by Yosua Ian Sebastian</title>
<meta name=keywords content="git,til,site"><meta name=description content="How I learned about git submodules behavior when trying to deploy this site."><meta name=author content="Yosua"><link rel=canonical href=https://darcien.dev/p/wheres-my-index-html/><link crossorigin=anonymous href=/assets/css/stylesheet.0c4fd3725171366f335155acde6fb3c7b7042cd2fd075bebf5023d9b28a701b2.css integrity="sha256-DE/TclFxNm8zUVWs3m+zx7cELNL9B1vr9QI9myinAbI=" rel="preload stylesheet" as=style><link rel=apple-touch-icon sizes=180x180 href="/apple-touch-icon.png?v=2"><link rel=icon type=image/png sizes=32x32 href="/favicon-32x32.png?v=2"><link rel=icon type=image/png sizes=16x16 href="/favicon-16x16.png?v=2"><link rel=manifest href="/site.webmanifest?v=2"><link rel=mask-icon href="/safari-pinned-tab.svg?v=2" color=#34343c><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link crossorigin=anonymous href=/style.css rel="preload stylesheet" as=style><meta property="og:title" content="Where's My index.html?"><meta property="og:description" content="How I learned about git submodules behavior when trying to deploy this site."><meta property="og:type" content="article"><meta property="og:url" content="https://darcien.dev/p/wheres-my-index-html/"><meta property="article:section" content="p"><meta property="article:published_time" content="2020-05-20T19:18:21+07:00"><meta property="article:modified_time" content="2020-05-20T19:18:21+07:00"><meta property="og:site_name" content="A blog by Yosua Ian Sebastian"><meta name=twitter:card content="summary"><meta name=twitter:title content="Where's My index.html?"><meta name=twitter:description content="How I learned about git submodules behavior when trying to deploy this site."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ps","item":"https://darcien.dev/p/"},{"@type":"ListItem","position":2,"name":"Where's My index.html?","item":"https://darcien.dev/p/wheres-my-index-html/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Where's My index.html?","name":"Where\u0027s My index.html?","description":"How I learned about git submodules behavior when trying to deploy this site.","keywords":["git","til","site"],"articleBody":"Intro ‚ÄúI can‚Äôt wait to try out the new Daddy Caddy!‚Äù\nThat‚Äôs what I thought while working on this new site. Caddy just released their v2 the other day. So I wanted to replace my old Nginx server just for the sake of it.\nBefore doing that, maybe it‚Äôs better if I have something to serve from the server.\n‚ÄúIt‚Äôs time for you to graduate from redirect slave!‚Äù.\nAnd that‚Äôs my main reason for making this site. This site is generated with Hugo and using a nice premade theme.\nJust add a bunch of markdowns, modify the config a bit, and maybe tweak the theme fonts, and I‚Äôm done!\nI didn‚Äôt think it would be this easy to make a site that looks nice(in my opinion). Deploying it should also be trivial right? Oh how I couldn‚Äôt be more wrong.\nProblem Initially, I wanted to make the site compile on my machine, pack it up, and scp it to the server.\nBut that‚Äôs boring. And there are other points that I care:\nWhat if I wanted to create a new post on a different machine? Do I need to setup the env on the other machine too? Maybe I want to automatically build if the site repo is updated? Okay, that‚Äôs it. I want to make the site compile on the server.\nI quickly created a new remote repo, pushed it all up, and then pulled it from the server.\nTo build the site, all I need is just the hugo binary. The server ran on a super common linux distro, should be easy.\nThe installation docs mentioned an official debian package available. Ran sudo apt-get install hugo, and the installation finished without problem. There‚Äôs a warning about the Linux package usually is a few versions behind. Well, a few versions behind should be fine right?\nSo, I went ahead and built the site, hugo -D, easy peasy. Now just need to serve the build result.\nHere‚Äôs where things start to spiral down.\nWhen I tried opening the site, it‚Äôs returning 403. Why!?\nOh, maybe I forgot to change the permission for the build result directory. Hmm, no, it‚Äôs already 755.\nSo I checked the access log. Hmm, it‚Äôs accessing the right thing, there‚Äôs nothing out of norm.\nMoving on, I checked the content of the build directory. Aha! There‚Äôs no index.html in the build result. Which is weird‚Ä¶ Why the resulting build is different here? My machine is MacOS, and I believe in Hugo‚Äôs cross platform support. Maybe there‚Äôs something else?\nHmmmmm, maybe it‚Äôs the hugo binary itself ü§î. Surprise! Running hugo version gives me v0.40.1. Man this is really old, I could find one or two fossils in here.\nMight as well install the binary with the same version as my machine directly. At the current time, it‚Äôs v0.71.0. Proceed to download and install the binary, yada yada yada, now I got the same version on the server.\nAfter building with same binary, the output should be the same. Wrong! It still doesn‚Äôt generate the index.html üò≠.\nPretty desperate at this point. Maybe I should recheck the entire source again? Hmm, there‚Äôs nothing out of the norm. The theme? I highly doubt it, but let‚Äôs check it anyway.\nHuh? The theme directory is empty? What happened here, I‚Äôm pretty sure I commited the entire theme to the repo.\nIs it because I used git submodule to add the theme? A quick googling tells me that this is case.\nWhen you clone a project with submodule in it, by default you get the directories that contain submodules, but none of the files within them yet.1\nOMG, all the time I spent debugging this. I probably could save them if I actually read how to use submodules first.\nSince I already cloned the repo, all I need is to fetch the missing submodules. This command did the trick:\n# This command will fetch and update all the submodules in the repo. $ git submodule update --init --recursive Finally, it‚Äôs the moment of truth.\nYatta! The index.html is here, and I can open the site ü•≥üéâ.\nNow my old server has been officially promoted to be a redirect servant and HTML server.\nConclusion Be careful when running any commands that you‚Äôre not familiar with. While it might work now. It might cause headache or maybe even trip you in the future. Proceed carefully üòâ.\nhttps://git-scm.com/book/en/v2/Git-Tools-Submodules¬†‚Ü©Ô∏é\n","wordCount":"734","inLanguage":"en","datePublished":"2020-05-20T19:18:21+07:00","dateModified":"2020-05-20T19:18:21+07:00","author":{"@type":"Person","name":"Yosua"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://darcien.dev/p/wheres-my-index-html/"},"publisher":{"@type":"Organization","name":"A blog by Yosua Ian Sebastian","logo":{"@type":"ImageObject","url":"https://darcien.dev/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://darcien.dev/ accesskey=h title="Yosua Ian Sebastian (Alt + H)"><img src=https://darcien.dev/whale_goth.svg alt aria-label=logo height=28>Yosua Ian Sebastian</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://darcien.dev/now title=now><span>now</span></a></li><li><a href=https://darcien.dev/about title=about><span>about</span></a></li><li><a href=https://darcien.dev/uses title=uses><span>uses</span></a></li><li><a href=https://darcien.dev/archive title=archive><span>archive</span></a></li><li><a href=https://darcien.dev/tags title=tags><span>tags</span></a></li><li><a href=https://darcien.dev/search title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://status.darcien.dev/ title=status><span>status</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Where's My index.html?</h1><div class=post-meta><span title='2020-05-20 19:18:21 +0700 WIB'>2020-05-20</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;734 words&nbsp;¬∑&nbsp;Yosua</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#problem>Problem</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><h2 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h2><p>&ldquo;I can&rsquo;t wait to try out the new <del>Daddy</del> Caddy!&rdquo;</p><p>That&rsquo;s what I thought while working on this new site.
<a href=https://caddyserver.com/v2>Caddy</a> just released their v2 the other day.
So I wanted to replace my old Nginx server just for the sake of it.</p><p>Before doing that, maybe it&rsquo;s better if I have something to serve from the server.</p><p>&ldquo;It&rsquo;s time for you to graduate from redirect slave!&rdquo;.</p><p>And that&rsquo;s my main reason for making this site.
This site is generated with <a href=https://gohugo.io/>Hugo</a> and using a nice premade <a href=https://github.com/panr/hugo-theme-terminal>theme</a>.</p><p>Just add a bunch of markdowns, modify the config a bit, and maybe tweak the theme fonts, and I&rsquo;m done!</p><p>I didn&rsquo;t think it would be this easy to make a site that looks nice(in my opinion).
Deploying it should also be trivial right? Oh how I couldn&rsquo;t be more wrong.</p><h2 id=problem>Problem<a hidden class=anchor aria-hidden=true href=#problem>#</a></h2><p>Initially, I wanted to make the site compile on my machine, pack it up, and <code>scp</code> it to the server.</p><p>But that&rsquo;s boring.
And there are other points that I care:</p><ul><li>What if I wanted to create a new post on a different machine? Do I need to setup the env on the other machine too?</li><li>Maybe I want to automatically build if the site repo is updated?</li></ul><p>Okay, that&rsquo;s it. I want to make the site compile on the server.</p><p>I quickly created a new remote repo, pushed it all up, and then pulled it from the server.</p><p>To build the site, all I need is just the <code>hugo</code> binary.
The server ran on a super common linux distro, should be easy.</p><p>The installation docs mentioned an official debian package available.
Ran <code>sudo apt-get install hugo</code>, and the installation finished without problem.
There&rsquo;s a warning about the Linux package usually is a few versions behind.
Well, a <em>few</em> versions behind should be fine right?</p><p>So, I went ahead and built the site, <code>hugo -D</code>, easy peasy.
Now just need to serve the build result.</p><p>Here&rsquo;s where things start to spiral down.</p><p>When I tried opening the site, it&rsquo;s returning 403. Why!?</p><p>Oh, maybe I forgot to change the permission for the build result directory.
Hmm, no, it&rsquo;s already 755.</p><p>So I checked the access log. Hmm, it&rsquo;s accessing the right thing, there&rsquo;s nothing out of norm.</p><p>Moving on, I checked the content of the build directory.
Aha! There&rsquo;s no <code>index.html</code> in the build result.
Which is weird&mldr; Why the resulting build is different here?
My machine is MacOS, and I believe in Hugo&rsquo;s cross platform support.
Maybe there&rsquo;s something else?</p><p>Hmmmmm, maybe it&rsquo;s the <code>hugo</code> binary itself ü§î.
Surprise! Running <code>hugo version</code> gives me <code>v0.40.1</code>.
Man this is really old, I could find one or two fossils in here.</p><p>Might as well install the binary with the same version as my machine directly.
At the current time, it&rsquo;s <code>v0.71.0</code>.
Proceed to download and install the binary, yada yada yada, now I got the same version on the server.</p><p>After building with same binary, the output should be the same.
Wrong! It still doesn&rsquo;t generate the <code>index.html</code> üò≠.</p><p>Pretty desperate at this point.
Maybe I should recheck the entire source again?
Hmm, there&rsquo;s nothing out of the norm.
The theme? I highly doubt it, but let&rsquo;s check it anyway.</p><p>Huh? The theme directory is empty?
What happened here, I&rsquo;m pretty sure I commited the entire theme to the repo.</p><p>Is it because I used <code>git submodule</code> to add the theme? A quick googling tells me that this is case.</p><blockquote><p>When you clone a project with submodule in it, by default you get the directories that contain submodules, but none of the files within them yet.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p></blockquote><p>OMG, all the time I spent debugging this.
I probably could save them if I actually read how to use submodules first.</p><p>Since I already cloned the repo, all I need is to fetch the missing submodules.
This command did the trick:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># This command will fetch and update all the submodules in the repo.</span>
</span></span><span class=line><span class=cl>$ git submodule update --init --recursive
</span></span></code></pre></div><p>Finally, it&rsquo;s the moment of truth.</p><p>Yatta! The <code>index.html</code> is here, and I can open the site ü•≥üéâ.</p><p>Now my old server has been officially promoted to be a redirect servant and HTML server.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Be careful when running any commands that you&rsquo;re not familiar with.
While it might work now.
It might cause headache or maybe even trip you in the future.
Proceed carefully üòâ.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://git-scm.com/book/en/v2/Git-Tools-Submodules>https://git-scm.com/book/en/v2/Git-Tools-Submodules</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://darcien.dev/tags/git/>git</a></li><li><a href=https://darcien.dev/tags/til/>til</a></li><li><a href=https://darcien.dev/tags/site/>site</a></li></ul><nav class=paginav><a class=prev href=https://darcien.dev/p/buyee-or-geekjack/><span class=title>¬´ Prev</span><br><span>Buyee or Geek Jack?</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 A blog by Yosua Ian Sebastian</span><br><span>Blog logo is a recolored <a target=_blank referrerpolicy=no-referrer rel=noopener href=https://twemoji.twitter.com/>Spouting Whale Twemoji</a> by Twitter, Inc
and other contributors and is licensed under <a target=_blank referrerpolicy=no-referrer rel=noopener href=https://creativecommons.org/licenses/by/4.0/>CC-BY
4.0</a></span><div class=footer-blank>This space intentionally left blank.</div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>